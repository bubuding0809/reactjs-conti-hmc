{"ast":null,"code":"var _jsxFileName = \"/Users/dingruoqian/Desktop/code/reactjs-conti-hmc/src/components/VideoStreamer.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useRef, useEffect } from \"react\";\nimport VideoForm from \"./VideoForm\";\nimport VideoControls from \"./VideoControls\";\nimport ReactPlayer from \"react-player\";\nimport { Box, Stack } from \"@mui/material\";\nimport { usePrevious } from \"./hooks\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction VideoStreamer() {\n  _s();\n\n  // Create a ref to store the video player instance\n  const playerRef = useRef(); // Create url state for video url form\n\n  const [playerUrl, setPlayerUrl] = useState(\"https://vimeo.com/712561471\"); // Create state for video player\n\n  const [playerState, setPlayerState] = useState({\n    url: \"https://vimeo.com/712561471\",\n    playing: false,\n    controls: false,\n    played: 0,\n    volume: 0.5,\n    muted: true,\n    loop: true,\n    playbackRate: 1,\n    seeking: false\n  }); // Create state to store previous player state\n\n  const previousPlaying = useRef(false);\n  useEffect(() => {\n    previousPlaying.current = playerState.playing;\n  }, [playerState.playing]);\n  const formProps = {\n    playerUrl,\n    setPlayerUrl,\n    handleLoad: () => {\n      setPlayerState(prevState => ({ ...prevState,\n        url: playerUrl\n      }));\n    }\n  };\n  const playerProps = { ...playerState,\n    ref: playerRef,\n    style: {\n      position: \"absolute\",\n      top: 0,\n      left: 0,\n      backgroundColor: \"black\"\n    },\n    width: \"100%\",\n    height: \"100%\",\n    onEnded: () => {\n      setPlayerState(prevState => ({ ...prevState,\n        playing: prevState.loop\n      }));\n    },\n    onProgress: state => {\n      if (!playerState.seeking) {\n        setPlayerState(prevState => ({ ...prevState,\n          played: state.played * 100\n        }));\n      }\n    }\n  };\n  const controlProps = {\n    playerRef,\n    playerState,\n    toggleVideoPlay: () => {\n      setPlayerState(prevState => ({ ...prevState,\n        playing: !prevState.playing\n      }));\n    },\n    toggleVideoLoop: () => {\n      setPlayerState(prevState => ({ ...prevState,\n        loop: !prevState.loop\n      }));\n    },\n    toggleVideoMute: () => {\n      setPlayerState(prevState => ({ ...prevState,\n        muted: !prevState.muted\n      }));\n    },\n    handleSeekChange: e => {\n      playerRef.current.seekTo(parseFloat(e.target.value) / 100, \"fraction\");\n      setPlayerState(prevState => ({ ...prevState,\n        played: parseFloat(e.target.value)\n      }));\n    },\n    handleSeekStart: e => {\n      setPlayerState(prevState => ({ ...prevState,\n        seeking: true,\n        playing: false\n      }));\n    },\n    handleSeekCommitted: e => {\n      console.log(previousPlaying, playerState.playing);\n      setPlayerState(prevState => ({ ...prevState,\n        seeking: false,\n        playing: previousPlaying.current\n      }));\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(Box, {\n    p: 3,\n    children: /*#__PURE__*/_jsxDEV(Stack, {\n      spacing: 1,\n      children: [/*#__PURE__*/_jsxDEV(VideoForm, { ...formProps\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Box, {\n        sx: {\n          position: \"relative\",\n          paddingTop: \"56.25%\"\n        },\n        children: /*#__PURE__*/_jsxDEV(ReactPlayer, { ...playerProps\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(VideoControls, { ...controlProps\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 121,\n    columnNumber: 9\n  }, this);\n}\n\n_s(VideoStreamer, \"xTrz6PZ+4nQ3sO58zkd+0nCsJ3U=\");\n\n_c = VideoStreamer;\nexport default VideoStreamer;\n\nvar _c;\n\n$RefreshReg$(_c, \"VideoStreamer\");","map":{"version":3,"names":["React","useState","useRef","useEffect","VideoForm","VideoControls","ReactPlayer","Box","Stack","usePrevious","VideoStreamer","playerRef","playerUrl","setPlayerUrl","playerState","setPlayerState","url","playing","controls","played","volume","muted","loop","playbackRate","seeking","previousPlaying","current","formProps","handleLoad","prevState","playerProps","ref","style","position","top","left","backgroundColor","width","height","onEnded","onProgress","state","controlProps","toggleVideoPlay","toggleVideoLoop","toggleVideoMute","handleSeekChange","e","seekTo","parseFloat","target","value","handleSeekStart","handleSeekCommitted","console","log","paddingTop"],"sources":["/Users/dingruoqian/Desktop/code/reactjs-conti-hmc/src/components/VideoStreamer.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from \"react\";\nimport VideoForm from \"./VideoForm\";\nimport VideoControls from \"./VideoControls\";\nimport ReactPlayer from \"react-player\";\nimport { Box, Stack } from \"@mui/material\";\nimport { usePrevious } from \"./hooks\";\n\nfunction VideoStreamer() {\n    // Create a ref to store the video player instance\n    const playerRef = useRef();\n\n    // Create url state for video url form\n    const [playerUrl, setPlayerUrl] = useState(\"https://vimeo.com/712561471\");\n\n    // Create state for video player\n    const [playerState, setPlayerState] = useState({\n        url: \"https://vimeo.com/712561471\",\n        playing: false,\n        controls: false,\n        played: 0,\n        volume: 0.5,\n        muted: true,\n        loop: true,\n        playbackRate: 1,\n        seeking: false,\n    });\n\n    // Create state to store previous player state\n    const previousPlaying = useRef(false);\n\n    useEffect(() => {\n        previousPlaying.current = playerState.playing;\n    }, [playerState.playing]);\n\n    const formProps = {\n        playerUrl,\n        setPlayerUrl,\n        handleLoad: () => {\n            setPlayerState(prevState => ({\n                ...prevState,\n                url: playerUrl,\n            }));\n        },\n    };\n\n    const playerProps = {\n        ...playerState,\n        ref: playerRef,\n        style: {\n            position: \"absolute\",\n            top: 0,\n            left: 0,\n            backgroundColor: \"black\",\n        },\n        width: \"100%\",\n        height: \"100%\",\n        onEnded: () => {\n            setPlayerState(prevState => ({\n                ...prevState,\n                playing: prevState.loop,\n            }));\n        },\n        onProgress: state => {\n            if (!playerState.seeking) {\n                setPlayerState(prevState => ({\n                    ...prevState,\n                    played: state.played * 100,\n                }));\n            }\n        },\n    };\n\n    const controlProps = {\n        playerRef,\n        playerState,\n        toggleVideoPlay: () => {\n            setPlayerState(prevState => ({\n                ...prevState,\n                playing: !prevState.playing,\n            }));\n        },\n        toggleVideoLoop: () => {\n            setPlayerState(prevState => ({\n                ...prevState,\n                loop: !prevState.loop,\n            }));\n        },\n        toggleVideoMute: () => {\n            setPlayerState(prevState => ({\n                ...prevState,\n                muted: !prevState.muted,\n            }));\n        },\n        handleSeekChange: e => {\n            playerRef.current.seekTo(\n                parseFloat(e.target.value) / 100,\n                \"fraction\"\n            );\n            setPlayerState(prevState => ({\n                ...prevState,\n                played: parseFloat(e.target.value),\n            }));\n        },\n        handleSeekStart: e => {\n            setPlayerState(prevState => ({\n                ...prevState,\n                seeking: true,\n                playing: false,\n            }));\n        },\n        handleSeekCommitted: e => {\n            console.log(previousPlaying, playerState.playing);\n            setPlayerState(prevState => ({\n                ...prevState,\n                seeking: false,\n                playing: previousPlaying.current,\n            }));\n        },\n    };\n    return (\n        <Box p={3}>\n            <Stack spacing={1}>\n                <VideoForm {...formProps} />\n                <Box\n                    sx={{\n                        position: \"relative\",\n                        paddingTop: \"56.25%\",\n                    }}\n                >\n                    <ReactPlayer {...playerProps} />\n                </Box>\n                <VideoControls {...controlProps} />\n            </Stack>\n        </Box>\n    );\n}\n\nexport default VideoStreamer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}